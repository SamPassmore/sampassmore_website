{
  "hash": "ea9cc68d973e6ca9983f668b1756996c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'To make a reference group, or to not make a reference group, that is the question\n  this blog deals with. '\nauthor: R package build\ndate: '2023-02-15'\nslug: []\ncategories: []\ntags: []\nDescription: ''\nTags: []\nCategories: []\nDisableComments: no\n---\n\n\n\n\nWhen modelling a single categorical variable in linear regression, there are two possibilities. Most commonly, and the default in R, is to estimate the difference between each level of the categorical variable relative to one reference (or baseline) level. This is called reference level coding. The less common alternative is to model each category separately, without a baseline, called level means coding. The choice between these two depends on what hypothesis you want to test, and changes the interpretation of coefficients and p-values. But first, lets understand the difference in what the model coefficients estimate. \n\nTo illustrate this example, imagine we have two societies of people who are known for their musical performance. One society, which we will call society A, is known for their preference for singing together, or group singing. As an example of group singing, we might think of the grand and unified choruses [found in Samoa](https://theglobaljukebox.org/#?share=Samoa_Female-and-Male-Chorus-Sing-Modern-Melody). \n\nIn the second society, society B, most songs only involve one singer, or solo singing. For an example of solo singing, consider the vivid tales told by solo singers [throughout the British Isles](https://theglobaljukebox.org/#?share=Ulster_The-Bold-English-Navvy). \n\nBetween these two fake societies, both groups perform group singing and solo singing, but 8 out of 10 songs from A are group singing, but only 2 from 10 within B.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf = data.frame(group = rep(c(\"A\", \"B\"), each = 10),\n                singing = c(rep(0:1, times = c(2, 8)),\n                            rep(0:1, times = c(8, 2))))\n```\n:::\n\n\nIf we run the model with an intercept we will be using reference level coding. Group A will become the reference level to which other groups are compared. The intercept will be the ratio of group and solo songs, and the coefficient will tell us how different society B is from society A. If the model is run without an intercept, then we are performing level means coding, and the coefficients will estimate the ratio of group singing songs to solo singing within each society. \n\nLet's look at the actual output. `fit.1` contains the formula `singing ~ group`. By default, the modelling function `glm` includes an intercept, and makes the first level of the factor the baseline. So the formula really looks like this: `singing ~ 1 + group`. By default, the baseline factor is the first in the alphabet, society A. \n\n\n::: {.cell layout-align=\"center\" messages='false'}\n\n```{.r .cell-code}\nfit.1 = glm(singing ~ group, \n             data = df, \n           family = \"binomial\")\n```\n:::\n\n\nIn the second model the formula is `singing ~ 0 + group`. The part of the formula `0 +`  specifically tells the modelling function to have no intercept, and model each category as a seperate level. \n\n\n::: {.cell layout-align=\"center\" messages='false'}\n\n```{.r .cell-code}\nfit.2 = glm(singing ~ 0 + group,\n            data = df, \n            family = \"binomial\")\n```\n:::\n\n\nLet's check the coefficients do what we think. \n\nSince we use a logistic regression, the raw coefficients are in log odds. To get the odds ratio, we exponentiate the results. Remember, society A has 2 songs which are sung by soloists, and 8 songs which are sung by a group, so society A's ratio is `8/2 = 4`. Society B has the reverse, 2 songs sung in a group and 8 songs sung by soloists, `2/8 = 0.25`. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### The True ratios \n# Within each society\nratios = tapply(df$singing, df$group, function(x) sum(x==1)/sum(x==0))\nratios\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   A    B \n4.00 0.25 \n```\n\n\n:::\n\n```{.r .cell-code}\n# The ratio between ratios \nratios[2] / ratios[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     B \n0.0625 \n```\n\n\n:::\n:::\n\n\nTo see if the model is estimating correctly, we compare the true ratios above, to the model coefficients. The first model should show the ratio of the baseline society as the intercept, society A = 4, and difference in ratios between groups as the coefficient. The second should return the ratios within each society, 4 for society A, and 0.25 for society B. That is, 4 / 0.25 = 0.0625. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Model Estimates of the ratios \n# Ratio of the baseline group and the difference between groups\nexp(coef(fit.1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)      groupB \n     4.0000      0.0625 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Group A is the baseline and intercept\nexp(coef(fit.1)[1]) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n          4 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Group B is the baseline + the differences between groups\nexp(coef(fit.1)[1] + coef(fit.1)[2]) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept) \n       0.25 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Difference between Group A and Group B \nexp(coef(fit.1)[2]) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ngroupB \n0.0625 \n```\n\n\n:::\n:::\n\n\nThe model with no intercept returns the estimated ratios for each society. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Ratios within each group\nexp(coef(fit.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ngroupA groupB \n  4.00   0.25 \n```\n\n\n:::\n:::\n\n\n## Should I use a reference group or not? \n\nThe choice between having a reference group or not depends on the hypothesis you want to test, and importantly changes the interpretation of the coefficent p-values. Let's consider the two hypotheses based on our fictional group singing vs solo singing data. \n\nIf we use a reference group, we have one coefficient estimating the difference in ratios between society A and society B. The p-value for the intercept in this model is testing whether the ratio of group singing to solo singing _in the reference group_ is different from 0. The p-value for the coefficient is testing the hypotheses \"Is this society B the same, or different from society A\". \n\nThe p-values in a model without a reference group (that is, with no intercept), then the all the p-values are testing the hypotheses that the ratio of group singing to solo singing is not zero. \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}